#include "Texture.h"
#include "Debugging.h"
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Texture::Texture()
	:m_pTexture(nullptr)
{

}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Texture::~Texture()
{

}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

bool Texture::LoadTexture(ID3D11Device* pDevice, WCHAR* filename)
{
	ScratchImage* img = new ScratchImage;
	TexMetadata texMeta;
	HRESULT hr = LoadFromTGAFile(filename, &texMeta, *img);
	if (FAILED(hr))
	{
		VS_LOG_VERBOSE("Failed to load tex from file");
		return false;
	}

	hr = CreateShaderResourceView(pDevice, img->GetImage(0, 0, 0), 1, texMeta, &m_pTexture);
	if (FAILED(hr))
	{
		VS_LOG_VERBOSE("Texture failed to load");
		return false;
	}
	delete img;

	return true;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void Texture::Shutdown()
{
	if (m_pTexture)
	{
		m_pTexture->Release();
		m_pTexture = nullptr;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

ID3D11ShaderResourceView* Texture::GetTexture()
{
	return m_pTexture;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
